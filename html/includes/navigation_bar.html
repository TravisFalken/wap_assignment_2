<?php
if (!isset($current_page)) {
  $current_page = '';
}
?>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <?php echo '<a class="navbar-brand" href="' . BASE_URL . 'index.php">ComputersRUs</a>'; ?>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <?php
      $home = '
      <li class="nav-item';
      if ($current_page == 'index') {
        $home = $home . ' active';
      }
      $home = $home . '">
        <a class="nav-link" href="' . BASE_URL . 'index.php">Home <span class="sr-only">(current)</span></a>
      </li>';
      echo $home;
      ?>
      <?php
      $shop = ' <li class="nav-item';
      if ($current_page == 'shop') {
        $shop = $shop . ' active';
      }
      $shop = $shop . '"><a class="nav-link" href="' . BASE_URL . 'shop.php"><i class="fas fa-store"></i>  Shop</a></li>';
      echo $shop;

      ?>
      <?php
      //Make sure user has admin privileges
      if (isset($_SESSION['user_level']) && $_SESSION['user_level'] == 1) {
        $manageUsers = ' <li class="nav-item';
        if ($current_page == 'manage_users') {
          $manageUsers = $manageUsers . ' active';
        }
        $manageUsers = $manageUsers . '"><a class="nav-link" href="' . BASE_URL . 'manage_users.php"><i class="fas fa-users"></i>  Manage Users</a></li>';

        echo $manageUsers;
      }

      ?>

      <?php
      if (isset($_SESSION['user_level']) && $_SESSION['user_level'] == 1) {
        echo ' <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Manage Products
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="' . BASE_URL . 'manage_products/add_product.php">Add Product</a>
                    <a class="dropdown-item" href="' . BASE_URL . 'manage_products/manage_product.php">Manage Products</a>
                  </div>
                </li>';
      }
      ?>

      <?php
      //Only show if logged in
      if (isset($_SESSION['first_name'])) {
        $account = '<li class="nav-item dropdown';

        if ($current_page == 'manage_account') {
          $account = $account . ' active';
        }
        $account = $account . '">
                              <a class="nav-link dropdown-toggle" href="#" id="accountDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-user"></i>  Account</a>
                              <div class="dropdown-menu" aria-labelledby="accountDropdown">
                                <a class="dropdown-item" href="' . BASE_URL . 'manage_users/edit_user.php?id=' . $_SESSION['user_id'] . '">Edit Account</a>
                                <a class="dropdown-item" href="' . BASE_URL . 'change_password.php">Change Password</a>
                              </div>
                            </li>';
        echo $account;
      }
      ?>
    </ul>
    <ul class="navbar-nav">
      <?php
      echo '<li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="far fa-question-circle"></i>  Help
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="' . BASE_URL . 'faq.php">FAQ\'s</a>
        </div>
      </li>';
      ?>
      <?php
      //Only show if logged in
      if (isset($_SESSION['first_name'])) {
        echo '<li class="nav-item">
                <a class="nav-link" href="' . BASE_URL . 'logout.php"><i class="fas fa-sign-out-alt"></i>  Logout</a>
            </li>';
      } else {
        $register = '
                  <li class="nav-item';
        if ($current_page == "register") {
          $register = $register . ' active';
        }
        $register = $register . '"><a class="nav-link" href="' . BASE_URL . 'register.php"><i class="fas fa-user-plus"></i>  Register</a>
                </li>';
        echo $register;

        $login = '<li class="nav-item ';
        if ($current_page == "login") {
          $login = $login . ' active';
        }
        $login = $login . '"><a class="nav-link" href="' . BASE_URL . 'login.php"><i class="fas fa-sign-in-alt"></i>  Login</a>
        </li>';
        echo $login;
      }
      ?>
      <?php
      if (isset($_SESSION['first_name'])) {
        echo '<li class="nav-item">
              <a class="nav-link" href="' . BASE_URL . 'view_cart.php"><i class="fas fa-shopping-cart custom-cart"></i></a>
            </li>';
      }
      ?>
    </ul>
  </div>
</nav>